!function(t){function e(s){if(i[s])return i[s].exports;var a=i[s]={exports:{},id:s,loaded:!1};return t[s].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e){var i=function(){function t(t,e){this.row=t,this.column=e,this.element=$("<div class='cell notBombed'></div>")[0]}return t.parseCellLocation=function(t){var e=t.split(",");return{row:parseInt(e[0]),column:parseInt(e[1])}},t.prototype.cellLocation=function(){return""+this.row+","+this.column},t}(),s=function(){function t(t){this.size=t,this.column=0,this.row=0,this.isVertical=!0,this.hits=0,this.element=$("<div class='ship'></div>")[0]}return t.prototype.updatePosition=function(t,e,i){this.row=t,this.column=e,this.isVertical=i,this.updateLayout()},t.prototype.updateLayout=function(){var t="9.9%",e=""+9.9*this.size+"%";this.element.style.left=""+10*this.column+"%",this.element.style.top=""+10*this.row+"%",this.element.style.width=this.isVertical?t:e,this.element.style.height=this.isVertical?e:t},t.prototype.flipShip=function(){this.isVertical=!this.isVertical,this.isVertical?this.row+this.size>10&&(this.row=10-this.size):this.column+this.size>10&&(this.column=10-this.size),this.updateLayout()},t.prototype.getCellsCovered=function(){for(var t=[],e=this.row,i=this.column,s=0;s<this.size;s++)t.push(e.toString()+","+i.toString()),this.isVertical?e++:i++;return t},t.prototype.isSunk=function(){return this.hits===this.size},t}(),a=function(){function t(t,e){var a=this;void 0===e&&(e=!0),this.element=t,this.playerTurn=!1,this.shipSizes=[5,4,3,3,2],this.positioningEnabled=e,this.cells=[],this.ships=[];for(var o=null,n=0;10>n;n++){this.cells[n]=[];for(var r=0;10>r;r++)o=new i(n,r),this.cells[n][r]=o,t.appendChild(o.element),$(o.element).data("cellLocation",o.cellLocation()),e&&$(o.element).droppable({disabled:!1,drop:function(t,e){var i=e.draggable[0],s=$(i).data("shipIndex"),n=a.ships[s],r=Math.round(i.offsetLeft/o.element.offsetWidth),l=Math.round(i.offsetTop/o.element.offsetHeight);n.updatePosition(l,r,n.isVertical)}})}for(var l=$(o.element),h=0;h<this.shipSizes.length;h++){var u=new s(this.shipSizes[h]);this.ships[h]=u,u.updatePosition(h,0,!1),e&&(this.element.appendChild(u.element),u.updateLayout(),$(u.element).data("shipIndex",h).draggable({disabled:!1,containment:"parent",grid:[.99*l.width()+2,.99*l.height()+2],cursor:"crosshair"}).click(function(t){if(a.positioningEnabled){var e=$(t.target).data("shipIndex");a.ships[e].flipShip()}}))}$(window).resize(function(t){$(a.element).children(".ship").draggable("option","grid",[.99*l.width()+2,.99*l.height()+2])}),e||$(t).click(function(t){return a.onCellClick(t)})}return Object.defineProperty(t.prototype,"dragAndDropEnabled",{set:function(t){var e=$(this.element).children(".cell"),i=$(this.element).children(".ship");this.positioningEnabled=t,i.draggable("option","disabled",!t),e.droppable("option","disabled",!t)},enumerable:!0,configurable:!0}),t.getRandomPosition=function(){return{row:Math.floor(10*Math.random()),column:Math.floor(10*Math.random()),vertical:1===Math.floor(2*Math.random())}},t.prototype.onCellClick=function(t){var e=t.target;$(e).hasClass("cell")!==!1&&(this.playerTurn||this.onEvent.call(this,"click"),this.playerTurn&&this.bombCell(e))},t.prototype.bombCell=function(t){var e=i.parseCellLocation($(t).data("cellLocation")),s=this.cells[e.row][e.column];if(!s.hasHit)if(s.hasHit=!0,s.shipIndex>=0){$(t).removeClass("notBombed"),$(t).addClass("cellHit");var a=this.ships[s.shipIndex];a.hits++,a.isSunk()?this.allShipsSunk()?this.onEvent.call(this,"allSunk"):this.onEvent.call(this,"shipSunk"):this.onEvent.call(this,"hit")}else $(t).removeClass("notBombed"),$(t).addClass("cellMiss"),this.onEvent.call(this,"playerMissed")},t.prototype.randomize=function(){var e=this.ships.length;do for(var i=0;e>i;i++){var s=t.getRandomPosition();this.ships[i].updatePosition(s.row,s.column,s.vertical)}while(!this.boardIsValid())},t.prototype.boardIsValid=function(){for(var t=[],e=0;e<this.ships.length;e++)t=t.concat(this.ships[e].getCellsCovered());t.sort();var s=t.some(function(t,e,i){return t===i[e+1]}),a=t.some(function(t){var e=i.parseCellLocation(t);return!(e.column>=0&&e.column<=9&&e.row>=0&&e.row<=9)});return s||a?!1:(this.updateCellData(),!0)},t.prototype.chooseMove=function(){do var e=t.getRandomPosition(),i=this.cells[e.row][e.column];while(i.hasHit);this.bombCell(i.element)},t.prototype.updateCellData=function(){for(var t=0;100>t;t++){var e=this.cells[Math.floor(t/10)][t%10];e.hasHit=!1,e.shipIndex=-1}for(var s=0;s<this.ships.length;s++){var a=this.ships[s];a.hits=0;for(var o=a.getCellsCovered(),n=0;n<o.length;n++){var r=i.parseCellLocation(o[n]),l=this.cells[r.row][r.column];l.shipIndex=s}}$(this.element).children(".cell").removeClass("cellHit cellMiss").addClass("notBombed")},t.prototype.allShipsSunk=function(){return this.ships.every(function(t){return t.isSunk()})},t}();(function(){function t(){var e=this;this.state=t.gameState.begin,this.updateStatus(t.msgs.gameStart),this.playerBoard=new a($("#playerBoard")[0]),this.computerBoard=new a($("#computerBoard")[0],!1),this.computerBoard.randomize(),this.playerBoard.randomize(),this.playerBoard.dragAndDropEnabled=!0,this.computerBoard.onEvent=function(i){switch(i){case"click":switch(e.state){case t.gameState.begin:e.startGame();break;case t.gameState.computerTurn:e.updateStatus(t.msgs.wait);break;case t.gameState.finished:e.computerBoard.randomize(),e.playerBoard.randomize(),e.playerBoard.dragAndDropEnabled=!0,e.updateStatus(t.msgs.gameStart),e.state=t.gameState.begin}break;case"playerMissed":e.computersTurn();break;case"hit":e.updateStatus(t.msgs.hit),e.computersTurn();break;case"shipSunk":e.updateStatus(t.msgs.shipSunk),e.computersTurn();break;case"allSunk":e.state=t.gameState.finished,e.computerBoard.playerTurn=!1,e.updateStatus(t.msgs.allSunk)}},this.playerBoard.onEvent=function(i){switch(i){case"playerMissed":case"hit":e.computerBoard.playerTurn=!0;break;case"shipSunk":e.updateStatus(t.msgs.lostShip),e.computerBoard.playerTurn=!0;break;case"allSunk":e.updateStatus(t.msgs.lostGame),e.computerBoard.playerTurn=!1,e.state=t.gameState.finished}}}return t.prototype.computersTurn=function(){var e=this;this.computerBoard.playerTurn=!1,this.state=t.gameState.computerTurn,setTimeout(function(){e.playerBoard.chooseMove()},250)},t.prototype.startGame=function(){this.playerBoard.boardIsValid()?(this.state=t.gameState.playerTurn,this.playerBoard.dragAndDropEnabled=!1,this.computerBoard.playerTurn=!0,this.updateStatus(t.msgs.gameOn)):this.updateStatus(t.msgs.invalidPositions)},t.prototype.updateStatus=function(t){$("#status").slideUp("fast",function(){$(this).text(t).slideDown("fast")})},t.gameState={begin:0,computerTurn:1,playerTurn:2,finished:3},t.msgs={gameStart:"Drag your ships to the desired location on your board (on the right), then bomb a square on the left board to start the game!",invalidPositions:"All ships must be in valid positions before the game can begin.",wait:"Wait your turn!",gameOn:"Game on!",hit:"Good hit!",shipSunk:"You sunk a ship!",lostShip:"You lost a ship :-(",lostGame:"You lost this time. Click anywhere on the left board to play again.",allSunk:"Congratulations!  You won!  Click anywhere on the left board to play again."},t})();$(new Function("var game = new Game();"))}]);